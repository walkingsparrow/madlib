/* -----------------------------------------------------------------------------
 * Test one-sample t-test.
 * 
 * Example ("ZARR13.DAT") taken from:
 * http://www.itl.nist.gov/div898/handbook/eda/section3/eda352.htm
 * -------------------------------------------------------------------------- */

CREATE TABLE ZARR13 (
	id SERIAL,
	value FLOAT8
);

INSERT INTO ZARR13(value) VALUES(9.206343);
INSERT INTO ZARR13(value) VALUES(9.299992);
INSERT INTO ZARR13(value) VALUES(9.277895);
INSERT INTO ZARR13(value) VALUES(9.305795);
INSERT INTO ZARR13(value) VALUES(9.275351);
INSERT INTO ZARR13(value) VALUES(9.288729);
INSERT INTO ZARR13(value) VALUES(9.287239);
INSERT INTO ZARR13(value) VALUES(9.260973);
INSERT INTO ZARR13(value) VALUES(9.303111);
INSERT INTO ZARR13(value) VALUES(9.275674);
INSERT INTO ZARR13(value) VALUES(9.272561);
INSERT INTO ZARR13(value) VALUES(9.288454);
INSERT INTO ZARR13(value) VALUES(9.255672);
INSERT INTO ZARR13(value) VALUES(9.252141);
INSERT INTO ZARR13(value) VALUES(9.297670);
INSERT INTO ZARR13(value) VALUES(9.266534);
INSERT INTO ZARR13(value) VALUES(9.256689);
INSERT INTO ZARR13(value) VALUES(9.277542);
INSERT INTO ZARR13(value) VALUES(9.248205);
INSERT INTO ZARR13(value) VALUES(9.252107);
INSERT INTO ZARR13(value) VALUES(9.276345);
INSERT INTO ZARR13(value) VALUES(9.278694);
INSERT INTO ZARR13(value) VALUES(9.267144);
INSERT INTO ZARR13(value) VALUES(9.246132);
INSERT INTO ZARR13(value) VALUES(9.238479);
INSERT INTO ZARR13(value) VALUES(9.269058);
INSERT INTO ZARR13(value) VALUES(9.248239);
INSERT INTO ZARR13(value) VALUES(9.257439);
INSERT INTO ZARR13(value) VALUES(9.268481);
INSERT INTO ZARR13(value) VALUES(9.288454);
INSERT INTO ZARR13(value) VALUES(9.258452);
INSERT INTO ZARR13(value) VALUES(9.286130);
INSERT INTO ZARR13(value) VALUES(9.251479);
INSERT INTO ZARR13(value) VALUES(9.257405);
INSERT INTO ZARR13(value) VALUES(9.268343);
INSERT INTO ZARR13(value) VALUES(9.291302);
INSERT INTO ZARR13(value) VALUES(9.219460);
INSERT INTO ZARR13(value) VALUES(9.270386);
INSERT INTO ZARR13(value) VALUES(9.218808);
INSERT INTO ZARR13(value) VALUES(9.241185);
INSERT INTO ZARR13(value) VALUES(9.269989);
INSERT INTO ZARR13(value) VALUES(9.226585);
INSERT INTO ZARR13(value) VALUES(9.258556);
INSERT INTO ZARR13(value) VALUES(9.286184);
INSERT INTO ZARR13(value) VALUES(9.320067);
INSERT INTO ZARR13(value) VALUES(9.327973);
INSERT INTO ZARR13(value) VALUES(9.262963);
INSERT INTO ZARR13(value) VALUES(9.248181);
INSERT INTO ZARR13(value) VALUES(9.238644);
INSERT INTO ZARR13(value) VALUES(9.225073);
INSERT INTO ZARR13(value) VALUES(9.220878);
INSERT INTO ZARR13(value) VALUES(9.271318);
INSERT INTO ZARR13(value) VALUES(9.252072);
INSERT INTO ZARR13(value) VALUES(9.281186);
INSERT INTO ZARR13(value) VALUES(9.270624);
INSERT INTO ZARR13(value) VALUES(9.294771);
INSERT INTO ZARR13(value) VALUES(9.301821);
INSERT INTO ZARR13(value) VALUES(9.278849);
INSERT INTO ZARR13(value) VALUES(9.236680);
INSERT INTO ZARR13(value) VALUES(9.233988);
INSERT INTO ZARR13(value) VALUES(9.244687);
INSERT INTO ZARR13(value) VALUES(9.221601);
INSERT INTO ZARR13(value) VALUES(9.207325);
INSERT INTO ZARR13(value) VALUES(9.258776);
INSERT INTO ZARR13(value) VALUES(9.275708);
INSERT INTO ZARR13(value) VALUES(9.268955);
INSERT INTO ZARR13(value) VALUES(9.257269);
INSERT INTO ZARR13(value) VALUES(9.264979);
INSERT INTO ZARR13(value) VALUES(9.295500);
INSERT INTO ZARR13(value) VALUES(9.292883);
INSERT INTO ZARR13(value) VALUES(9.264188);
INSERT INTO ZARR13(value) VALUES(9.280731);
INSERT INTO ZARR13(value) VALUES(9.267336);
INSERT INTO ZARR13(value) VALUES(9.300566);
INSERT INTO ZARR13(value) VALUES(9.253089);
INSERT INTO ZARR13(value) VALUES(9.261376);
INSERT INTO ZARR13(value) VALUES(9.238409);
INSERT INTO ZARR13(value) VALUES(9.225073);
INSERT INTO ZARR13(value) VALUES(9.235526);
INSERT INTO ZARR13(value) VALUES(9.239510);
INSERT INTO ZARR13(value) VALUES(9.264487);
INSERT INTO ZARR13(value) VALUES(9.244242);
INSERT INTO ZARR13(value) VALUES(9.277542);
INSERT INTO ZARR13(value) VALUES(9.310506);
INSERT INTO ZARR13(value) VALUES(9.261594);
INSERT INTO ZARR13(value) VALUES(9.259791);
INSERT INTO ZARR13(value) VALUES(9.253089);
INSERT INTO ZARR13(value) VALUES(9.245735);
INSERT INTO ZARR13(value) VALUES(9.284058);
INSERT INTO ZARR13(value) VALUES(9.251122);
INSERT INTO ZARR13(value) VALUES(9.275385);
INSERT INTO ZARR13(value) VALUES(9.254619);
INSERT INTO ZARR13(value) VALUES(9.279526);
INSERT INTO ZARR13(value) VALUES(9.275065);
INSERT INTO ZARR13(value) VALUES(9.261952);
INSERT INTO ZARR13(value) VALUES(9.275351);
INSERT INTO ZARR13(value) VALUES(9.252433);
INSERT INTO ZARR13(value) VALUES(9.230263);
INSERT INTO ZARR13(value) VALUES(9.255150);
INSERT INTO ZARR13(value) VALUES(9.268780);
INSERT INTO ZARR13(value) VALUES(9.290389);
INSERT INTO ZARR13(value) VALUES(9.274161);
INSERT INTO ZARR13(value) VALUES(9.255707);
INSERT INTO ZARR13(value) VALUES(9.261663);
INSERT INTO ZARR13(value) VALUES(9.250455);
INSERT INTO ZARR13(value) VALUES(9.261952);
INSERT INTO ZARR13(value) VALUES(9.264041);
INSERT INTO ZARR13(value) VALUES(9.264509);
INSERT INTO ZARR13(value) VALUES(9.242114);
INSERT INTO ZARR13(value) VALUES(9.239674);
INSERT INTO ZARR13(value) VALUES(9.221553);
INSERT INTO ZARR13(value) VALUES(9.241935);
INSERT INTO ZARR13(value) VALUES(9.215265);
INSERT INTO ZARR13(value) VALUES(9.285930);
INSERT INTO ZARR13(value) VALUES(9.271559);
INSERT INTO ZARR13(value) VALUES(9.266046);
INSERT INTO ZARR13(value) VALUES(9.285299);
INSERT INTO ZARR13(value) VALUES(9.268989);
INSERT INTO ZARR13(value) VALUES(9.267987);
INSERT INTO ZARR13(value) VALUES(9.246166);
INSERT INTO ZARR13(value) VALUES(9.231304);
INSERT INTO ZARR13(value) VALUES(9.240768);
INSERT INTO ZARR13(value) VALUES(9.260506);
INSERT INTO ZARR13(value) VALUES(9.274355);
INSERT INTO ZARR13(value) VALUES(9.292376);
INSERT INTO ZARR13(value) VALUES(9.271170);
INSERT INTO ZARR13(value) VALUES(9.267018);
INSERT INTO ZARR13(value) VALUES(9.308838);
INSERT INTO ZARR13(value) VALUES(9.264153);
INSERT INTO ZARR13(value) VALUES(9.278822);
INSERT INTO ZARR13(value) VALUES(9.255244);
INSERT INTO ZARR13(value) VALUES(9.229221);
INSERT INTO ZARR13(value) VALUES(9.253158);
INSERT INTO ZARR13(value) VALUES(9.256292);
INSERT INTO ZARR13(value) VALUES(9.262602);
INSERT INTO ZARR13(value) VALUES(9.219793);
INSERT INTO ZARR13(value) VALUES(9.258452);
INSERT INTO ZARR13(value) VALUES(9.267987);
INSERT INTO ZARR13(value) VALUES(9.267987);
INSERT INTO ZARR13(value) VALUES(9.248903);
INSERT INTO ZARR13(value) VALUES(9.235153);
INSERT INTO ZARR13(value) VALUES(9.242933);
INSERT INTO ZARR13(value) VALUES(9.253453);
INSERT INTO ZARR13(value) VALUES(9.262671);
INSERT INTO ZARR13(value) VALUES(9.242536);
INSERT INTO ZARR13(value) VALUES(9.260803);
INSERT INTO ZARR13(value) VALUES(9.259825);
INSERT INTO ZARR13(value) VALUES(9.253123);
INSERT INTO ZARR13(value) VALUES(9.240803);
INSERT INTO ZARR13(value) VALUES(9.238712);
INSERT INTO ZARR13(value) VALUES(9.263676);
INSERT INTO ZARR13(value) VALUES(9.243002);
INSERT INTO ZARR13(value) VALUES(9.246826);
INSERT INTO ZARR13(value) VALUES(9.252107);
INSERT INTO ZARR13(value) VALUES(9.261663);
INSERT INTO ZARR13(value) VALUES(9.247311);
INSERT INTO ZARR13(value) VALUES(9.306055);
INSERT INTO ZARR13(value) VALUES(9.237646);
INSERT INTO ZARR13(value) VALUES(9.248937);
INSERT INTO ZARR13(value) VALUES(9.256689);
INSERT INTO ZARR13(value) VALUES(9.265777);
INSERT INTO ZARR13(value) VALUES(9.299047);
INSERT INTO ZARR13(value) VALUES(9.244814);
INSERT INTO ZARR13(value) VALUES(9.287205);
INSERT INTO ZARR13(value) VALUES(9.300566);
INSERT INTO ZARR13(value) VALUES(9.256621);
INSERT INTO ZARR13(value) VALUES(9.271318);
INSERT INTO ZARR13(value) VALUES(9.275154);
INSERT INTO ZARR13(value) VALUES(9.281834);
INSERT INTO ZARR13(value) VALUES(9.253158);
INSERT INTO ZARR13(value) VALUES(9.269024);
INSERT INTO ZARR13(value) VALUES(9.282077);
INSERT INTO ZARR13(value) VALUES(9.277507);
INSERT INTO ZARR13(value) VALUES(9.284910);
INSERT INTO ZARR13(value) VALUES(9.239840);
INSERT INTO ZARR13(value) VALUES(9.268344);
INSERT INTO ZARR13(value) VALUES(9.247778);
INSERT INTO ZARR13(value) VALUES(9.225039);
INSERT INTO ZARR13(value) VALUES(9.230750);
INSERT INTO ZARR13(value) VALUES(9.270024);
INSERT INTO ZARR13(value) VALUES(9.265095);
INSERT INTO ZARR13(value) VALUES(9.284308);
INSERT INTO ZARR13(value) VALUES(9.280697);
INSERT INTO ZARR13(value) VALUES(9.263032);
INSERT INTO ZARR13(value) VALUES(9.291851);
INSERT INTO ZARR13(value) VALUES(9.252072);
INSERT INTO ZARR13(value) VALUES(9.244031);
INSERT INTO ZARR13(value) VALUES(9.283269);
INSERT INTO ZARR13(value) VALUES(9.196848);
INSERT INTO ZARR13(value) VALUES(9.231372);
INSERT INTO ZARR13(value) VALUES(9.232963);
INSERT INTO ZARR13(value) VALUES(9.234956);
INSERT INTO ZARR13(value) VALUES(9.216746);
INSERT INTO ZARR13(value) VALUES(9.274107);
INSERT INTO ZARR13(value) VALUES(9.273776);

CREATE TABLE t_test_one AS
SELECT (t_test_one(value - 5.0)).* FROM zarr13;

SELECT * FROM t_test_one;
SELECT assert(
    relative_error(statistic, 2611.284) < 0.001 AND
    df = 194,
    'One-sample t-test: Wrong results'
) FROM t_test_one;

/* -----------------------------------------------------------------------------
 * Test one-sample t-test.
 * 
 * Example ("AUTO83B.DAT") taken from:
 * http://www.itl.nist.gov/div898/handbook/eda/section3/eda353.htm
 * -------------------------------------------------------------------------- */

CREATE TABLE auto83b (
    id SERIAL,
    mpg_us DOUBLE PRECISION,
    mpg_j DOUBLE PRECISION
);

INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,24);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,27);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,27);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,25);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(17,31);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,35);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,24);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,19);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,28);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,23);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,27);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,20);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,22);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,18);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(22,20);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,31);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,31);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(10,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(10,24);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(11,26);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(9,29);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(28,24);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(25,24);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,33);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,33);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(17,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,28);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,19);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,34);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,26);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,30);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(12,22);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,22);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,33);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,39);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(22,36);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,28);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,27);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(23,21);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(26,24);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(25,30);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,34);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,38);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,37);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,30);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,31);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(17,37);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(11,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,47);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(12,41);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,45);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,34);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,33);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,24);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(22,39);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(28,35);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,37);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,38);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,34);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,34);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(12,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,33);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,25);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,24);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(12,37);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,31);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,36);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,36);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,34);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,38);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(23,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(11,38);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(12,32);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(12,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(11,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(26,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(25,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(28,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(14,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(17,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(23,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(23,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(25,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(26,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(22,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(22,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(24,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(23,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(29,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(25,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(17,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(13,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(30,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(26,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(17,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(15,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(25,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(26,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(31,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(34,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(36,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(25,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(30,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(31,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(23,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(24,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(22,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(22,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(21,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(17,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(17,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(17,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(16,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(36,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(23,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(24,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(34,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(35,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(28,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(29,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(34,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(32,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(28,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(26,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(24,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(19,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(28,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(24,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(26,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(24,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(30,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(39,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(35,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(34,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(30,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(22,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(20,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(18,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(28,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(34,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(31,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(29,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(24,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(23,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(38,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(36,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(25,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(38,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(26,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(22,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(36,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(27,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(32,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(28,-999);
INSERT INTO auto83b (mpg_us, mpg_j) VALUES(31,-999);

CREATE TABLE t_test_two_pooled AS
SELECT (t_test_two_pooled(is_us, mpg)).* FROM (
    SELECT TRUE AS is_us, mpg_us AS mpg
    FROM auto83b
    WHERE mpg_us != -999
    UNION ALL
    SELECT FALSE, mpg_j
    FROM auto83b
    WHERE mpg_j != -999
) q;

CREATE TABLE t_test_two_unpooled AS
SELECT (t_test_two_unpooled(is_us, mpg)).* FROM (
    SELECT TRUE AS is_us, mpg_us AS mpg
    FROM auto83b
    WHERE mpg_us != -999
    UNION ALL
    SELECT FALSE, mpg_j
    FROM auto83b
    WHERE mpg_j != -999
) q;

SELECT * FROM t_test_two_pooled;
SELECT assert(
    relative_error(statistic, -12.62059) < 0.001 AND
    df = 326,
    'Pooled two-sample t-test: Wrong results'
) FROM t_test_two_pooled;

SELECT * FROM t_test_two_unpooled;
SELECT assert(
    relative_error(statistic, -12.94627) < 0.001 AND
    relative_error(df, 136.875) < 0.001,
    'Unpooled two-sample t-test: Wrong results'
) FROM t_test_two_unpooled;
